library(readr)
#X2014GJMN <- read_delim("D:/PC_Archive/PHD/data_csv/2014GJMN.csv", 
#                        delim = ";", escape_double = FALSE, trim_ws = TRUE)
# View(X2014GJMN)
# Data prep not_survive.
library(haven)
data_prep <- read_sav("D:/PC_Archive/PHD/spss-modeller - IBM Academic Initiative/popov-phd-data/3_data_preparation/data_prep.sav")
View(data_prep)

length(data_prep)

# Data prep survive.
# library(haven)
# data_prep_survive <- read_sav("D:/PC_Archive/PHD/spss-modeller - IBM Academic Initiative/popov-phd-data/3_data_preparation/data_prep_survive.sav")
# View(data_prep_survive)
# 
# length(data_prep_survive)

# rename columns:
library(xlsx)
column_names_df <- read.xlsx("D:/PC_Archive/PHD/r_scripts/r-phd/r-phd-project/varible_names/variables.xlsx",sheetName = "Sheet")
column_names <- as.list(column_names_df)
# View(column_names)
colnames(data_prep) <- unlist(column_names)

write.csv(data_prep,"D:/PC_Archive/PHD/r_scripts/r-phd/r-phd-project/samples/data_prep.csv",row.names =  FALSE)
data_prep_csv <-read.csv("D:/PC_Archive/PHD/r_scripts/r-phd/r-phd-project/samples/data_prep.csv")
## Replace NA values:

#impute the missing data using RF regressions predictions
# md.pattern(data_prep)
subsetTempData <- as.character(data_prep[,136:ncol(data_prep)])
subsetTempData <- as.integer(subsetTempData)

tempData <- mice(data_prep_csv, m=2, maxit=4, meth='rf', seed=50)

ReviewsProcessed_merged_imp <- complete(tempData, 1)

ReviewsProcessed_merged_imp_sent_levels <- ReviewsProcessed_merged_imp

ReviewsProcessed_merged_imp_sent_levels[4:15] <- as.data.frame(lapply(ReviewsProcessed_merged_imp_sent_levels[4:15],
                                                                      function(x) ifelse(x < -0.1, "Neg",
                                                                                         ifelse(x >= -0.1 & x <= 0.1, "Neu", "Pos"))))
